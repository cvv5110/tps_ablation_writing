\section{Physics-Infused Reduced-Order Modeling}\label{sec_pirom}
The formulation of PIROM for ablating TPS starts by connecting the FOM, i.e., DG-FEM, and the RPM, i.e., the LCM, via a coarse-graining procedure. This procedure pinpoints the missing dynamics in the LCM when compared to DG-FEM. Subsequently, the Mori-Zwanzig (MZ) formalism is employed to determine the model form for the missing dynamics in PIROM. Lastly, the data-driven identification of the missing dynanmics in PIROM is presented.

\subsection{Deriving the Reduced-Physics Model via Coarse-Graining}
The LCM is derived from a full-order DG on a fine mesh via coarse graining. This process constraints the trial function space of a full-order DG model to a subset of piece-wise constants, so that the variables $\vu$, matrices $\vA$, $\vB$, and $\vC$, and forcing vector $\vf$ are all approximated using a single state associated to the average temperature. The details of the projection are described next.

\subsubsection{Coarse-Graining of States}

Consider a DG model as in \cref{eqn_full_dg} for M elements and an LCM as in \cref{eqn_lcm} for $N$ components; clearly $M\gg N$. Let $\cV_j = \left\{i \big| E_i\in\Omega_j\right\}$ be the indices of the elements belonging to the $j$-th component, so $E_i\in\Omega_j$ for all $i\in \cV_j$. The number of elements in the $j$-th component is $|\cV_j|$. The average temperature on $\Omega_j$ is,
\begin{equation}
    \bar{u}_j = \frac{1}{|\Omega_j|}\sum_{i\in\cV_j}\intEi \vphi^{(i)}(x)^T\vu^{(i)} d\Omega = \frac{1}{\left|\Omega_j\right|}\sum_{i\in\cV_j} \left|E_i\right|\vvarphi_i^{j\top}\vu^{(i)},\quad j=1,2,\dots,N\label{eqn_average_temperature}
\end{equation}
where $\left|\Omega_j\right|$ and $\left|E_i\right|$ denote the area $(d=2)$ or volume $(d=3)$ of component $j$ and element $i$, respectively. The orthogonal basis functions are defined as $\vvarphi_i^{j\top} = \left[1,0,\dots,0\right]^{\top}\in\mathbb{R}^{P}$.

Conversely, given the average temperatures of the $N$ components, $\bvu$, the states of an arbitrary element $E_i$ is written as,
\begin{equation}
    \vu^{(i)} = \sum_{k=1}^{N}\vvarphi_i^{k}\bar{u}_k + \deltavu^{(i)}, \quad i=1,2,\dots,M\label{eqn_element_states}
\end{equation}
where $\vvarphi_{i}^{k}=0$ if $i\notin\cV_k$, and $\deltavu^{(i)}$ represents the deviation from the average temperature and satisfies the orthogonality condition $\vvarphi_{i}^{k\top}\deltavu^{(i)}=0$ for all $k$.

Equations \cref{eqn_average_temperature,eqn_element_states} are combined and written in matrix form as,
\begin{equation}
    \bvu = \vPhiplus\vu,\quad \vu = \vPhi\vu + \deltavu
\end{equation}
where $\vPhi\in\mathbb{R}^{MP\times N}$ is a matrix of $M\times N$ blocks, with the $(i,j)$-th block as $\vvarphiij$, $\vPhiplus\in\mathbb{R}^{N\times MP}$ is the left inverse of $\vPhi$, with the $(i,j)$-th block as $\vvarphi_{i}^{j+} = \frac{|E_i|}{|\Omega_j|}\vvarphiijT$, and $\deltavu$ is the collection of deviations. By their definitions, $\vPhiplus\vPhi = \vI$ and $\vPhiplus\deltavu = \vzero$.

\subsubsection{Coarse-Graining of Dynamics}
Next, consider a function of states in the form of $\vM\left(\vu\right)\vg(\vu)$, where $\vg:\mathbb{R}^{MP} \to \mathbb{R}^{MP}$ is a vector-valued function, and $\vM:\mathbb{R}^{MP} \to \mathbb{R}^{p\times MP}$ is a matrix-valued function with an arbitrary dimension $p$. Define the projection matrix $\vP=\vPhi\vPhiplus$ and the projection operator $\cP$ as,
\begin{align}
    \cP\left[\vM(\vu)\vg(\vu)\right] &= \vM\left(\vP{\vu}\right)\vg\left(\vP{\vu}\right)\notag\\
    &= \vM\left(\vPhi\bvu\right)\vg\left(\vPhi\bvu\right)\label{eqn_projection_operator}
\end{align}
so that the resulting function depends only on the average temperatures $\bvu$. Correspondingly, the residual operator $\cQ = \cI - \cP$, and $\cQ\left[\vM(\vu)\vg(\vu)\right] = \vM(\vu)\vg(\vu) - \vM\left(\vPhi\bvu\right)\vg\left(\vPhi\bvu\right)$. When the function is not separable, the projection operator is simply defined as $\cP\left[\vg(\vu)\right] = \vg\left(\vP\vu\right)$.

Subsequently, the operators defined above are applied to coarse-grain the dynamics. First, write the DG-FEM in \cref{eqn_full_dg} as,
\begin{equation}
    \dot{\vu} = \vA(\vu)^{-1}\vB(\vu)\vu + \vA(\vu)^{-1}\vC(t,\vu)\vu + \vA(\vu)^{-1}\vf(t,\vu)\label{eqn_full_dg_rearranged}
\end{equation}
and multiply both sides by $\vPhiplus$ to obtain,
\begin{equation}
    \vPhiplus\dot{\vu} = \vPhiplus\left(\vPhi\dot{\bvu} + \delta\dot{\vu}\right) = \dot{\bvu} = \vPhiplus\vr(\vu,t)
\end{equation}
Apply the projection operator $\cP$ and the residual operator $\cQ$ to the right-hand side to obtain,
\begin{equation}
    \dot{\bvu} = \cP\left[\vPhiplus\vr(\vu,t)\right] + \cQ\left[\vPhiplus\vr(\vu,t)\right]\equiv \vr^{(1)}(\vu,t) + \vr^{(2)}(\vu,t)\label{eqn_coarse_grained_dynamics}
\end{equation}
where $\vr^{(1)}(\vu,t)$ is resolved dynamics that depends on $\bvu$ only, and $\vr^{(2)}(\vu,t)$ is the un-resolved or residual dynamics. Detailed derivations and analysis of $\vr^{(1)}(\vu,t)$ and $\vr^{(2)}(\vu,t)$ can be found in the Appendix. 

It follows from Ref.\hl{x} that the resolved dynamics is exactly the LCM, where the advection term reduces to zero, i.e., $\bvC(t,\vu) = \vzero$ as shown in the Appendix. Using the notation from \cref{eqn_lcm}, it follows that,
\begin{align}
    \vr^{(1)}(\vu,t) &= \bvA(\bvu)^{-1}\bvB(\bvu)\bvu + \bvA(\bvu)^{-1}\bvC(t,\bvu)\bvu + \bvA(\bvu)^{-1}\bvf(t,\bvu)\notag\\
    &= \bvA(\bvu)^{-1}\bvB(\bvu)\bvu + \bvA(\bvu)^{-1}\bvf(t)\label{eqn_resolved_dynamics_no_advection}
\end{align}
where the following relations hold,
\begin{subequations}
    \begin{align}
        \bvA(\bvu) &= \vW\left(\vPhiplus\vA\left(\vPhi\bvu\right)^{-1}\vPhi\right)^{-1} &\quad \bvC(t,\bvu) &= \vzero \\
        \bvB(\bvu) &= \vW\vPhiplus\vB\left(\vPhi\bvu\right)\vPhi &\quad \bvf(t) &= \vW\vPhiplus\vf
    \end{align}\label{eqn_coarse_grained_matrices}
\end{subequations}
where $\vW\in\mathbb{R}^{N\times N}$ is a diagonal matrix with the $i$-th element as $\left[\vW\right]_{ii} = \left|\cV_k\right|$ if $i\in\cV_k$. As shown in the Appendix, the examination of the second residual term $\vr^{(2)}(\vu,t)$ in \cref{eqn_coarse_grained_dynamics} reveals the physical sources of missing dynamics in the LCM: the approximation of non-uniform temperature within each component as a constant, and the elimination of the advection term due to coarse-graining.

In sum, the above results not only show that the LCM is a result of coarse-graining of the full-order DG-FEM, but also reveal the discrepancies between the LCM and the DG-FEM. In the subsequent section, the discrepancies will be corrected to produce the proposed PIROM.

\subsection{Formulation of Reduced-Order Model}

The Mori-Zwanzig (MZ) formalism is an operator-projection technique used to derive ROMs for high-dimensional dynamical systems, especially in statistical mechanics and fluid dynamics \hl{Parish,Duraisamy}. It provides an exact reformulation of the full-order dynamics in terms of a subset of resolved variables. The proposed ROM is subsequently developed based on such reformulation. Equation \cref{eqn_coarse_grained_dynamics} shows that the DG-FEM dynamics can be decomposed into the resolved dynamics $\vr^{(1)}(\vu,t)$ and the orthogonal dynamics $\vr^{(2)}(\vu,t)$, in the sense of $\cP\vr^{(2)}=0$. In this case, the MZ formalism can be invoked to express the dynamics $\bvu$ in terms of $\bvu$ alone as the projected Generalized Langevin Equation (GLE) \hl{Parish,Duraisamy},
\begin{equation}
    \dot{\bvu}(t) = \vr^{(1)}(\bvu,t) + \int_{0}^{t}\tvkappa(t,s,\bvu)ds\label{eqn_gle}
\end{equation}
where the first term is Markovian, and the integral term is referred to as the memory. The integral term is non-Markovian, accounting for impact of past resolved states on the current states through their interactions with the un-resolved states.

Next, to further inform the subsequent derivation of the ROM, the kernel $\tvk$ is examined via a leading-order expansion, based on prior work \hl{x}; this can be viewed as an analog of zeroth-order holding in linear system theory with a sufficiently small time step. In this case, the memory kernel is approximated as,
\begin{equation}
    \tvkappa(t,s,\bvu) \approx \vr^{(1)}(\bvu,t) \cdot \nabla_{\bvu}\vr^{(2)}\left(\vPhi\bvu,t\right)
\end{equation}
Note that the terms in $\vr^{(1)}$ have a common factor $\bvA^{-1}$; this motivates the following heuristic modification of the model form in \cref{eqn_gle},
\begin{subequations}
    \begin{align}
        \dot{\bvu} &= \vr^{(1)}(\bvu,t) + \bvA^{-1}(\bvu)\int_{0}^{t}\vkappa(t,s,\bvu)ds\label{eqn_pirom_gle}\\
        \bvA(\bvu) &= \bvB\left(\bvu\right)\bvu + \bvf(t) + \int_{0}^{t}\vkappa(t,s,\bvu)ds\label{eqn_lcm_gle}
    \end{align}
\end{subequations}
where the original kernel $\tvkappa$ is effectively normalized by $\bvA^{-1}$. Intuitively, such choice of kernel reduces its dependency on the averaged material properties, and simplifies the subsequent design of model form.

Subsequently, the hidden states are introduced to make the non-Markovian system in \cref{eqn_gle}, Markovian. In this manner, \cref{eqn_lcm_gle} is converted into a pure state-space model, with the functional form of the LCM retained; since LCM is a physics-based model, then it encodes the physical information and retains explicit parametric dependence of the problem. Consider the representation of the kernel as a finite sum of simpler functions, e.g., exponentials,
\begin{equation}
    \vkappa(t,s,\bvu) = \sum_{j=1}^{m}\cK_j(t,s)\left[\vp_j + \vd_j(t)\right]\phi_j(s)
\end{equation}
where,
\begin{equation}
    \cK_j(t,s) = e^{\int_{s}^{t}\left(-\lambda_j + e_j(\tau)\right)d\tau},\quad \phi_j(s) = \vq_j^{\top}\bvu(s) + \vg_j(s)^{\top}\bvu(s) + \vr_j^{\top}\bvf(s)
\end{equation}
with suitable coefficients $\vp_j,\vd_j,\vq_j,\vg_j,\vr_j\in\mathbb{R}^{N}$ and decay rates $\lambda_j,e_j(\tau)>0$, that need to be identified from data. 

Define the hidden states as,
\begin{equation}
    \beta_j(t) = \int_{0}^{t}\cK_j(s,t)\phi_j(s)ds
\end{equation}
then through its differentiation with respect to time,
\begin{equation}
    \dot{\beta}_j(t) = (-\lambda_j + e_j(t))\beta_j(t) + \vq_j^{\top}\bvu(t) + \vg_j(t)^{\top}\bvu(t) + \vr_j^{\top}\bvf(t)
\end{equation}
and the memory term becomes,
\begin{equation}
    \int_{0}^{t}\vkappa(t,s,\bvu)ds = \sum_{j=1}^{m}\left[\vp_j + \vd_j(t)\right]\beta_j(t)
\end{equation}
Then, \cref{eqn_lcm_gle} is recast as the extended Markovian s ystem,
\begin{subequations}
    \begin{align}
        \bvA(\bvu)\dot{\bvu} &= \bvB(\bvu)\bvu + \bvf(t) + \left[\vP + \vD(t)\right]\vbeta \\
        \dot{\vbeta} &= \left[-\vLambda + \vE(t)\right]\vbeta + \left[\vQ + \vG(t)\right]\bvu + \vR\bvf(t)
    \end{align}
\end{subequations}
where,
\begin{subequations}
    \begin{align}
        \vLambda &= \text{diag}\left(\lambda_1,\lambda_2,\dots,\lambda_m\right)\in\mathbb{R}^{N\times m},\quad & \vP &= \left[\vp_1,\vp_2,\dots,\vp_m\right]\in\mathbb{R}^{N\times m}\\
        \vD(t) &= \left[\vd_1(t),\vd_2(t),\dots,\vd_m(t)\right]\in\mathbb{R}^{N\times m},\quad & \vQ &= \left[\vq_1,\vq_2,\dots,\vq_m\right]\in\mathbb{R}^{N\times m}\\
        \vG(t) &= \left[\vg_1(t),\vg_2(t),\dots,\vg_m(t)\right]\in\mathbb{R}^{N\times m},\quad & \vR &= \left[\vr_1,\vr_2,\dots,\vr_m\right]\in\mathbb{R}^{N\times m}
    \end{align}
\end{subequations}
Since the hidden states $\vbeta$ serve as the memory, their initial conditions are set to zero, i.e., $\vbeta(t_0) = \vzero$, no memory at the beginning.

Lastly, denote the collection of resolved and hidden states as $\vy = \left[\bvu,\vbeta\right]^T\in\mathbb{R}^{n_y}$ with $n_y = N+m$, then the proposed PIROM is summarized as,
\begin{subequations}
    \begin{align}
        \tilde{\vA}\dot{\vy} &= \left[\tilde{\vB} +\tilde{\vC}(t)\right]\vy + \tilde{\vf}(t)\\
        \vz &= \vO\vy
    \end{align}
\end{subequations}
where,
\begin{gather}
    \tilde{\vA} = \begin{bmatrix}
        \bvA(\bvu) & \vO\\
        \vO & \vI
    \end{bmatrix},\quad \tilde{\vB} = \begin{bmatrix}
        \bvB(\bvu) & \vP\\
        \vQ & -\vLambda
    \end{bmatrix},\quad\tilde{\vC}(t) = \begin{bmatrix}
        \vzero & \vD(t)\\
        \vG(t) & \vE(t)
    \end{bmatrix},\quad
    \tilde{\vf}(t) = \begin{bmatrix}
        \bvf(t)\\
        \vR^{\top}\bvf(t)
    \end{bmatrix},\quad
    \vO = \begin{bmatrix}
        \vI & \vzero
    \end{bmatrix}
\end{gather}




