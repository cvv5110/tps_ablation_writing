\section{Modeling of Ablating Thermal Protection Systems}

This section presents the problem of modeling a non-decomposing ablating TPS subjected to extreme hypersonic heating. Two different but mathematically connected solution strategies are provided: (1) a high-fidelity full-order model (FOM) based on a finite element method (FEM), and (2) a low-fidelity reduced-physics model (RPM) based on a lumped capacitance model (LCM) and a one-dimensional surface velocity model (SVM). The FOM is computationally expensive but provides the highest fidelity, while the RPM is computationally efficeint but has low predictive fidelity; both models are amenable to high-dimensional design variables. The RPM is used in the subsequent sections for deriving the PIROM.

\subsection{Governing Equations}\label{sec_governing_equations}
The multi-physics for a non-decomposing ablating TPS involves the \textit{energy equation} which models the transient heat conduction inside the TPS, and the \textit{pseudo-elasticity equation}, which models the mesh motion due to surface recession. The governing PDEs for the ablating TPS are summarized in this section.

\subsubsection{Energy Equation}
Consider a generic domain $\Omega\subset$, $d=2$ or $3$, illustrated in Fig.~\ref{fig_general_domain}. Let $\partial\Omega = \Gamma_q\cup\Gamma_T$ and $\Gamma_q\cap\Gamma_T = \emptyset$, where a Neumann $q_b(x,t)$ boundary condition is prescribed on the $\Gamma_q$ boundary, and represents the surface exposed to the hypersonic boundary layer. The Dirichlet $T_b(x,t)$ boundary condition is prescribed on the boundary $\Gamma_T$. The TPS is divided into $N$ non-overlapping components $\left\{\Omega_i\right\}_{i=1}^{N}$, as illustrated in Fig.~\ref{fig_general_domain} for $N=2$. The $i$-th component $\Omega_i$ is associated with material properties $\left(\rho_i,c_{p,i}, \vk_i\right)$, that are assumed to be continuous within one component, and can be discontinuous across two neighboring components. 

\begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{./figs/general_domain.png}
    \caption{General domain $\Omega$ with prescribed Neumann and Dirichlet boundary conditions on $\Gamma_q$ and $\Gamma_T$. Mesh displacement $w(x,t)$ occurs on the $\Gamma_q$ boundary.}
    \label{fig_general_domain}
\end{figure}

The transient heat conduction is described by the energy equation,
\begin{subequations}
    \begin{align}
        \rho c_p\left(\ppt{T} + \tilde{\vv}(x,t)\cdot\nabla T\right) - \nabla\cdot (\mathbf{k}\nabla T) &= 0,\ x\in\Omega \label{eqn_thermal_pde}\\
        -\mathbf{k}\nabla T\cdot \vn &= q_b(x,t),\ x\in\Gamma_q\label{eqn_thermal_bc_neumann}\\
        T(x,t) &= T_b(x,t),\ x\in\Gamma_T\label{eqn_thermal_bc_dirichlet}\\
        T(x,0) &= T_0(x),\ x\in\Omega\label{eqn_thermal_ic}
    \end{align}\label{eqn_governing_equations}
\end{subequations}
where the density $\rho$ is constant, while the heat capacity $c_p$ and thermal conductivity $\mathbf{k}\in\mathbb{R}^{d\times d}$ may depend on temperature. In the order they appear, the terms in \cref{eqn_thermal_pde} include, the unsteady energy storage, heat conduction, temperature advection due to mesh motion, and source terms due to boundary conditions. The boundary conditions for the energy equation includes Neumann \cref{eqn_thermal_bc_neumann} and Dirichlet \cref{eqn_thermal_bc_dirichlet} on $\Gamma_T$. 

An Abirtrary Lagrangian-Eulerian (ALE) description is used to account for mesh motion due to surface recession, where $\tilde{\vv}(x,t)$ is the relative velocity of the material with respect to the mesh,
\begin{equation}
    \tilde{\vv}(x,t) = \vv_s(x,t) - \vv_m(x,t)\label{eqn_relative_velocity}
\end{equation}
where $\vv_s(x,t)$ and $\vv_m(x,t)$ are the physical material velocity and mesh velocity, respectively. In this work, the physical material velocity is assumed to be zero, i.e., $\vv_s(x,t)=\vzero$, and thus the relative velocity is simply the negative of the mesh velocity, $\tilde{\vv}(x,t) = -\vv_m(x,t)$.

\subsubsection{Pseudo-Elasticity Equation}
The mesh motion is described by the steady-state pseudo-elasticity equation without body forces,
\begin{subequations}
    \begin{align}
        \nabla\cdot\vsigma(\vw) &= \vzero,\quad \forall\:t\in\cT,\:\vx\in\Omega\quad\label{eqn_elasticity_pde}\\
        \vw(\vx,t) &= \vw_q(\vx,t),\quad \forall\:t\in\cT,\: \vx\in\Gamma_q\label{eqn_displacement_heated_bc}\\
        \vw(\vx,t) &= \vzero,\quad \forall\:t\in\cT,\: \vx\notin \Gamma_q\label{eqn_displacement_unheated_bc}\\
        \vw(\vx,0) &= \vzero,\quad \forall\:\vx\in\Omega\label{eqn_displacement_initial_condition}
    \end{align}
\end{subequations}
where the stress tensor $\vsigma$ is related to the strain tensor $\vepsilon(\vw)$ through Hooke's law,
\[
    \vsigma(\vw) = \mathbb{D}:\vepsilon(\vw)
\]
where $\mathbb{D}$ is the fourth-order positive definite elasticity tensor, and ``:'' is the double contraction of the full-order tensor $\mathbb{D}$ with the second-order tensor $\vepsilon$. The elasticity tensor ordinarily possess a number of symmetries, effectively reducing the number of components that describe it~\cite{Bergel2022}. The symmetric strain tensor $\vepsilon$ measures the deformation of the mesh due to displacements $\vw(x,t)$, and is defined as,
\[
    \vepsilon(\vw) = \frac{1}{2}\left(\nabla\vw + \nabla\vw^\top\right)
\]
The ``material'' properties for the mesh are chosen to tailor the mesh deformation, and need not represent the actual material being modeled~\cite{Amar2016}.

For the pseudo-elasticity equations, the boundary conditions include prescribed displacements $\vw_q(x,t)$ on the heated boundary $\Gamma_q$ in \cref{eqn_displacement_heated_bc}, and zero displacements on the unheated boundaries in \cref{eqn_displacement_unheated_bc}. The initial condition for the mesh displacements is zero in \cref{eqn_displacement_initial_condition}. Particularly, the surface velocity due to the ablating material is a function of the surface temperature $T_q(x,t)$ for $x\in\Gamma_q$ on the heated boundary. For the $i$-th material component, the mesh velocity on the heated boundary is imposed based on the following relation,
\begin{equation}
    \hat{\vn}\cdot\vv_m(x,t) = f(T_q(x,t)),\quad x\in\Gamma_q\label{eqn_boundary_velocity}
\end{equation}
where $\hat{\vn}$ is the unit normal vector on the heated boundary $\Gamma_q$, and $f$ is a function obtained from tabulated data for the material, commonly referred to as a B' table~\cite{Amar2016}. The B' table provides a model for the recession velocity as a function of the surface temperature, and is pre-computed based on high-fidelity simulations of the ablation process for a one-dimensional slab of the material, and is independent of the TPS geometry. Provided the surface velocity, the boundary condition in \cref{eqn_boundary_displacement} for the mesh displacements are computed by integrating the surface velocity over time,
\begin{equation}
    \vw_q(x,t) = \int_{0}^{t} \mathbf{v}_m(x,\tau)d\tau\label{eqn_boundary_displacement}
\end{equation}

\subsection{Full-Order Model: Finite-Element Method}\label{sec_fom}
To obtain the full-order numerical solution, the \textit{energy equation} is spatially discretized using variational principles of the Discontinuous Galerkin (DG) method~\cite{Cohen2018}. Note that the choice of DG approach is mainly for theoretical convenience, and is exclusively performed on the energy equation, as it is the surface temperature that drives the ablation process. The equivalence between DG and FEM is noted upon their convergence. For the \textit{pseudo-elasticity equation} standard FEM is used to compute the mesh displacements based on the surface temperature provided by the DG solution of the energy equation~\cite{Bergel2022}.

Consider a conforming mesh partition domain, where each element belongs to one and only one component. Denote the collection of all $M$ elements as $\left\{E_i\right\}_{i=1}^{M}$. In an element $E_i$, its shared boundaries with another element $E_j$, Neumann BC, and Dirichlet BC are denoted as $e_{ij}$, $e_{iq}$, and $e_{iT}$, respectively. Lastly, $\left|e\right|$ denotes the length $(n_d=2)$ or area $(n_d=3)$ of a component boundary $e$.

For the $i$-th element, use a set of $P$ trial functions, such as polynomials, to represent the temperature distribution,
\begin{equation}
    T_i(x,t) = \sum_{l=1}^{P} \phi_l^i(x) u_l^i(t) \equiv \vphi_i^\top(x)\vu_i(t),\quad i=1,2,\dots,M\label{eqn_element_temperature}
\end{equation}
Without loss of generality, the trial functions are assumed to be orthogonal, so that,
\[
    \int_{E_i}\phi_l^i(x)\phi_k^i(x)d\Omega = 0,\quad l\neq k
\] 
where $\delta_{lk}$ is the Kronecker delta function. Furthermore, for simplicity, choose $\phi_1^i=1$. Thus, by orthogonality,
\[
    \int_{E_i}\phi_1^i(x)d\Omega = |E_i|,\quad \int_{E_i}\phi_k^i(x)d\Omega = 0,\quad k=2,3,\dots,P
\]
Under the choice of basis functions, $u_1^i$ is simply the average temperature of element $E_i$, denoted as $\bu_i$.

By standard variational processes, e.g.,~\cite{Cohen2018}, the element-wise governing equation is denoted as,
\begin{equation}
    \vA_i\dot{\vu}_i = \left(\vB_i + \vC_i\right)\vu_i + \sumneighbordirichlet\left(\vB^i_{ij}\vu_i + \vB^{j}_{ij}\vu_j\right) + \vf_i(t),\quad\text{for }i=1,2,\dots,M\label{eqn_element_dg}
\end{equation}
which is collected as the following ODE for the all the elements in the mesh,
\begin{equation}
    \vA(\vu)\dot{\vu} = \left[\vB(\vu) + \vC(\vu)\right]\vu + \mathbf{f}(t)\label{eqn_full_dg}
\end{equation}
where $\vu = \left[\vu_1, \vu_2, \ldots, \vu_M\right]^\top\in\mathbb{R}^{MP}$ includes all the DG variables, $\mathbf{f}\in\mathbb{R}^{MP}$ is the external forcing, and the system matrices $\vA$, $\vB$, and $\vC$ are the matrices due to heat capacity, heat conduction, and temperature advection due to mesh motion, respectively. A detailed derivation of \cref{eqn_element_dg,eqn_full_dg} and their matrices is provided in Appendix~\ref{appendix_mathematical_details}.

\subsection{Reduced-Physics Model}
The RPM for predicting the response of the ablating TPS consists of two components: (1) the \textit{lumped-capacitance model} (LCM), and (2) the \textit{surface velocity model} (SVM). The LCM is described as a first-order system of ODEs for predicting the average temperatures inside the components of the TPS, and provides a low-fidelity (under estimate) for the component's surface temperature. The SVM provides a relation between the surface temperature and the surface recession velocity based on pre-computed B' tables for the material, enabling the computation of one-dimensional surface displacements. The LCM and SVM are combined to define the RPM, providing low-fidelity estimates for the temperatures and surface recession of the ablating TPS.

\subsubsection{Lumped Capacitance Model}
A general form of the LCM is provided in this section; details regarding the derivation for the four-component TPS in Fig.~\ref{fig_four_components} are provided in Appendix~\ref{appendix_mathematical_details}. The LCM is a classical physics-based low-order model for predicting the temporal variation of average temperature in multiple interconnected components~\cite{Incropera2011}. The LCM is derived at the component level from a point of view of energy conservation, and leads to the following system of ODEs for the average temperatures on the components,
\begin{equation}
    \bar{\vA}\dot{\bar{\vu}} = \bar{\vB}\bar{\vu} + \bar{\vf}(t)\label{eqn_lcm}
\end{equation}
Where the states and inputs,
\begin{equation}
    \bvu = \left[\bar{u}_1,\bar{u}_2,\dots,\bar{u}_N\right]^\top\in\mathbb{R}^{N},\quad \bar{\vf} = \left[\bar{f}_1,\bar{f}_2,\dots,\bar{f}_N\right]^\top\in\mathbb{R}^{N}\label{eqn_lcm_states_inputs}
\end{equation}
include the average temperatures $\bar{\vu}$ and spatially-integrated inputs $\bar{\vf}$ for the $N$ components. For $i,j=1,2,\dots,N$ the $(i,j)$-th elements of the $\bar{\vA}\in\mathbb{R}^{N\times N}$, $\bar{\vB}\in\mathbb{R}^{N\times N}$, and $\bar{\vf}\in\mathbb{R}^{N}$ matrices are given by,
\begin{subequations}
    \begin{gather}
        \bar{A}_i = \begin{cases}
                \int_{\Omega_i}\rho c_p d\Omega_i, & i=j\\
                0, & i\neq j
            \end{cases},\quad \bar{B}_{ij} = \begin{cases}
            \sumneighbordirichlet\bar{B}^i_{ij}, &i=j \\
            \bar{B}^{(j)}_{ij}, & i\neq j
        \end{cases},\\ \vf_i = \begin{cases}
            |\eiq|\bar{q}_i + \frac{|\eiT|}{R_{i}}\bar{T}_i, & i=j \\ 
            0, & i\neq j
        \end{cases}
    \end{gather}\label{eqn_lcm_matrices}
\end{subequations}
where,
\begin{equation}
    \bar{q}_i = \frac{1}{|\eiq|}\int_{\eiq} q_b d\eiq,\quad \bar{T}_i = \frac{1}{|\eiT|}\int_{\eiT}T_b d\eiT,\quad \bar{B}^{i}_{ij} = -\frac{|\eij|}{R_{ij}},\quad \bar{B}_{ij}^{j} = \frac{|\eij|}{R_{ij}}\label{eqn_lcm_matrices_elements}
\end{equation}
where $R_{ij}$ is the equivalent thermal resistance between two neighboring components $\Omega_i$ and $\Omega_j$, and $R_i$ is the thermal resistance between component $\Omega_i$ and the Dirichlet boundary. The thermal resistances are computed based on the geometry and material properties of the components; details regarding their computation are provided in Appendix~\ref{appendix_mathematical_details}.

\begin{figure}
    \centering
    \subfigure[TPS Decomposition]{\includegraphics[width=0.8\textwidth]{./figs/four_components.png}}
    \subfigure[Lumped Mass Representation]{\includegraphics[width=0.8\textwidth]{./figs/lumped_mass_representation.png}}
    \caption{Partition of the TPS into three ablating and one non-ablating components with the corresponding lumped-mass representation.}
    \label{fig_four_components}
\end{figure}

\subsubsection{Surface Velocity Model}
The displacement is assumed to be \textit{one-dimensional} on the heated boundary $\Gamma_q$, i.e., the surface recedes only in the direction of the applied load, and occurs only for $\tilde{N}\leq N$ components. For example, in Fig.~\ref{fig_four_components}, the surface displacement on the heated boundary occurs only in the negative $y$-direction for the three components exposed to the hypersonic boundary layer; the fourth component is the substrate and does not ablate. Displacements along the $x$ direction is small relative to displacements in the $y$ direction, and are thus neglected. 

For the $i$-th component, the SVM considered in this work takes the form,
\begin{equation}
    \dot{\vw} = \vXi\bvu - \tvf\label{eqn_svm}
\end{equation}
where $\vXi=\text{diag}\left(\xi_1,\dots,\xi_{\tilde{N}}\right)$ and $\tvf=\left(\xi_1\bu_{0,1},\dots,\xi_{\tilde{N}}\bu_{0,\tilde{N}}\right)^\top$. The constants $\xi_i$ are small material-dependent constants, determined from the B' table, and $\bu_{0,i}$ is the constant initial temperature of the component. The SVM provides a relation between the surface temperature and the surface recession velocity based on pre-computed B' tables for the material.

\subsubsection{Coupled Reduced-Physics Model}
The LCM and SVM are combined to define the RPM for predicting the thermo-ablative response of the TPS under hypersonic boundary layers. Specifically, the RPM is defined as the LCM as in \cref{eqn_lcm}, where the \textit{geometry-dependent matrices} $\bar{\vA}$, $\bar{\vB}$, and $\bar{\vf}$ are updated at each time step based on the current surface displacements $\vw$ provided by the SVM. The RPM is formally stated as,
\begin{equation}
    \vcA(\vs)\dot{\vs} = \vcB(\vs)\vs + \vcF(t)\label{eqn_rpm}
\end{equation}
where the state $\vs=\left[\bvu,\vw\right]^\top\in\mathbb{R}^{N+\tilde{N}}$ includes the average temperatures for $N$ components and the one-dimensional surface displacements for the $\tilde{N}$ ablating components. The matrices are given as,
\begin{equation}
    \vcA = \begin{bmatrix}
        \bar{\vA}(\vw) & \vzero\\
        \vzero & \vI
    \end{bmatrix},\quad \vcB(\vs) = \begin{bmatrix}
        \bar{\vB}(\vw) & \vzero\\
        \vXi & \vzero
    \end{bmatrix},\quad \vcF(t) = \begin{bmatrix}
        \bar{\vf}(t)\\
        -\tvf
    \end{bmatrix}\label{eqn_rpm_matrices}
\end{equation}
In the matrices $\bvA$ and $\bvB$, the surface displacements $\vw$ are used to define the dimensions for the $\Omega_i$ component used in \cref{eqn_lcm_matrices,eqn_lcm_matrices_elements}, thus effectively coupling the LCM and SVM.

\subsection{Summary of Modeling Approaches}
The FOM (i.e., DG-FEM) and RPM (i.e., LCM with SVM) are two different but mathematically connected solution strategies. Specifically, the LCM in \cref{eqn_lcm} not only resembles the functional form of the DG model in \cref{eqn_full_dg}, but can be viewed as a special case of the latter, where the mesh partition is extremely coarse, and the trial and test functions are piece-wise constants. This removes all spatial variations within each component, and neglects advection effects due to mesh motion.

For example, consider the case where each component $\Omega_i$ is treated as one single element, and each element employs one constant basis function $\phi_i=1$. The element-wise DG model in \cref{eqn_element_dg} simplifies into a scalar ODE,
\begin{equation}
    \vAi = \bar{A}_i,\quad \vCi = 0, \quad\vBiij = -\sigma|\eij|,\quad \vBjij=\sigma|\eij|,\quad \vf_i = |\eiq|\bar{q}_i + \sigma|\eiT|\bar{T}_i
\end{equation}
Clearly, the LCM is a coarse zeroth-order DG model with the inverse of thermal resistance chosen as the element-wise penalty factors. Or conversely, the DG model is a refined version of LCM via \textit{hp}-adaptation.

The FOM and RPM represent two extremes in the modeling fidelity and computational cost spectrum. On one hand, the FOM is the most accurate but computationally expensive to evaluate due to the fine mesh discretizations for both the temperature and displacement fields, leading to possibly millions of state variables. On the other hand, the RPM considers only the average temperature of the material from which one-dimensional surface displacements are computed. This considerably reduces the computational cost, but sacrifices local temperature information that are critical to properly capture higher-order effects due to mesh motion and thermal gradients within each component. Thus, neither the FOM nor the RPM is an universal approach for real-world analysis, design, and optimization tasks for ablating TPS, where thousands of high-fidelity model evaluations may be necessary. This issue motivates the development of the PIROM, which can achieve the fidelity of FOM at a computational cost close to the RPM, while maintaining the generalizability to model parameters.